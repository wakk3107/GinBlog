{"remainingRequest":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\user\\Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\user\\Profile.vue","mtime":1659593611446},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\babel.config.js","mtime":1651118941000},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1659170823565},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1659170825069}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL3dha2svR29sYW5kUHJvamVjdHMvR2luQmxvZy93ZWIvYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IFVybCB9IGZyb20gJy4uLy4uL3BsdWdpbi9odHRwJzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9maWxlSW5mbzogewogICAgICAgIGlkOiAxLAogICAgICAgIG5hbWU6ICcnLAogICAgICAgIGRlc2M6ICcnLAogICAgICAgIHFxX2NoYXQ6ICcnLAogICAgICAgIHdlY2hhdDogJycsCiAgICAgICAgd2VpYm86ICcnLAogICAgICAgIGJpbGk6ICcnLAogICAgICAgIGVtYWlsOiAnJywKICAgICAgICBpbWc6ICcnLAogICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgaWNwX3JlY29yZDogJycKICAgICAgfSwKICAgICAgdXBVcmw6IFVybCArICd1cGxvYWQnLAogICAgICBoZWFkZXJzOiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFByb2ZpbGVJbmZvKCk7CiAgICB0aGlzLmhlYWRlcnMgPSB7CiAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6I635Y+W5Liq5Lq66K6+572uCiAgICBnZXRQcm9maWxlSW5mbzogZnVuY3Rpb24gZ2V0UHJvZmlsZUluZm8oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfeWllbGQkX3RoaXMkJGh0dHAkZ2UsIHJlczsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuJGh0dHAuZ2V0KCJwcm9maWxlLyIuY29uY2F0KF90aGlzLnByb2ZpbGVJbmZvLmlkKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIF95aWVsZCRfdGhpcyQkaHR0cCRnZSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICByZXMgPSBfeWllbGQkX3RoaXMkJGh0dHAkZ2UuZGF0YTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMTAwNCB8fCAxMDA1IHx8IDEwMDYgfHwgMTAwNykgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5jbGVhcigpOwoKICAgICAgICAgICAgICAgICAgICBfdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMucHJvZmlsZUluZm8gPSByZXMuZGF0YTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIOS4iuS8oOWktOWDjwogICAgYXZhdGFyQ2hhbmdlOiBmdW5jdGlvbiBhdmF0YXJDaGFuZ2UoaW5mbykgewogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyAhPT0gJ3VwbG9hZGluZycpIHt9CgogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2RvbmUnKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCJcdTU2RkVcdTcyNDdcdTRFMEFcdTRGMjBcdTYyMTBcdTUyOUYiKTsKICAgICAgICB2YXIgaW1nVXJsID0gaW5mby5maWxlLnJlc3BvbnNlLnVybDsKICAgICAgICB0aGlzLnByb2ZpbGVJbmZvLmF2YXRhciA9IGltZ1VybDsKICAgICAgfSBlbHNlIGlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAnZXJyb3InKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigiXHU1NkZFXHU3MjQ3XHU0RTBBXHU0RjIwXHU1OTMxXHU4RDI1Iik7CiAgICAgIH0KICAgIH0sCiAgICAvLyDkuIrkvKDlpLTlg4/og4zmma/lm74KICAgIGltZ0NoYW5nZTogZnVuY3Rpb24gaW1nQ2hhbmdlKGluZm8pIHsKICAgICAgaWYgKGluZm8uZmlsZS5zdGF0dXMgIT09ICd1cGxvYWRpbmcnKSB7fQoKICAgICAgaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICdkb25lJykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygiXHU1NkZFXHU3MjQ3XHU0RTBBXHU0RjIwXHU2MjEwXHU1MjlGIik7CiAgICAgICAgdmFyIGltZ1VybCA9IGluZm8uZmlsZS5yZXNwb25zZS51cmw7CiAgICAgICAgdGhpcy5wcm9maWxlSW5mby5pbWcgPSBpbWdVcmw7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5wcm9maWxlSW5mby5pbWcpOwogICAgICB9IGVsc2UgaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICdlcnJvcicpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCJcdTU2RkVcdTcyNDdcdTRFMEFcdTRGMjBcdTU5MzFcdThEMjUiKTsKICAgICAgfQogICAgfSwKICAgIC8vIOabtOaWsAogICAgdXBkYXRlUHJvZmlsZTogZnVuY3Rpb24gdXBkYXRlUHJvZmlsZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgX3lpZWxkJF90aGlzMiQkaHR0cCRwLCByZXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLiRodHRwLnB1dCgicHJvZmlsZS8iLmNvbmNhdChfdGhpczIucHJvZmlsZUluZm8uaWQpLCBfdGhpczIucHJvZmlsZUluZm8pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfeWllbGQkX3RoaXMyJCRodHRwJHAgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIHJlcyA9IF95aWVsZCRfdGhpczIkJGh0dHAkcC5kYXRhOwoKICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT09IDIwMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX3RoaXMyLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5zdWNjZXNzKCJcdTRFMkFcdTRFQkFcdTRGRTFcdTYwNkZcdTY2RjRcdTY1QjBcdTYyMTBcdTUyOUYiKTsKCiAgICAgICAgICAgICAgICBfdGhpczIuJHJvdXRlci5wdXNoKCcvaW5kZXgnKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AAEA;AACAA,MADA,kBACA;AACA;AACAC;AACAC,aADA;AAEAC,gBAFA;AAGAC,gBAHA;AAIAC,mBAJA;AAKAC,kBALA;AAMAC,iBANA;AAOAC,gBAPA;AAQAC,iBARA;AASAC,eATA;AAUAC,kBAVA;AAWAC;AAXA,OADA;AAcAC,2BAdA;AAeAC;AAfA;AAiBA,GAnBA;AAoBAC,SApBA,qBAoBA;AACA;AACA;AAAAC;AAAA;AACA,GAvBA;AAwBAC;AACA;AACAC,kBAFA,4BAEA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,wDADA;;AAAA;AAAA;AACAC,mBADA,yBACAnB,IADA;AAEAoB;;AACA;AACA;AACAC;;AACA;AACA;;AACA;AACA;;AACA;;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA,KAbA;AAeA;AACAC,gBAhBA,wBAgBAC,IAhBA,EAgBA;AACA,6CACA;;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA,KA1BA;AA4BA;AACAC,aA7BA,qBA6BAD,IA7BA,EA6BA;AACA,6CACA;;AACA;AACA;AACA;AACA;AACAH;AACA,OALA,MAKA;AACA;AACA;AACA,KAxCA;AA0CA;AACAK,iBA3CA,2BA2CA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,8EADA;;AAAA;AAAA;AACAN,mBADA,yBACAnB,IADA;;AAAA,sBAEAmB,kBAFA;AAAA;AAAA;AAAA;;AAAA,kDAEA,kCAFA;;AAAA;AAGA;;AACA;;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAhDA;AAxBA","names":["data","profileInfo","id","name","desc","qq_chat","wechat","weibo","bili","email","img","avatar","icp_record","upUrl","headers","created","Authorization","methods","getProfileInfo","res","console","window","avatarChange","info","imgChange","updateProfile"],"sourceRoot":"src/components/user","sources":["Profile.vue"],"sourcesContent":["<template>\n  <a-card>\n    <a-form-model labelAlign=\"left\" :label-col=\"{ span: 2 }\" :wrapper-col=\"{ span: 12 }\">\n      <a-form-model-item label=\"作者名称\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.name\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"个人简介\">\n        <a-input type=\"textarea\" v-model=\"profileInfo.desc\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"网站备案号\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.icp_record\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"QQ号码\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.qq_chat\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"微信\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.wechat\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"微博\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.weibo\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"B站地址\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.bili\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"Email\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.email\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"头像\">\n        <a-upload\n          listType=\"picture\"\n          name=\"file\"\n          :action=\"upUrl\"\n          :headers=\"headers\"\n          @change=\"avatarChange\"\n        >\n          <a-button style=\"margin-right:10px\">\n            <a-icon type=\"upload\" />点击上传\n          </a-button>\n\n          <template v-if=\"profileInfo.avatar\">\n            <img :src=\"profileInfo.avatar\" style=\"width: 120px; height: 100px\" />\n          </template>\n        </a-upload>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"头像背景图\">\n        <a-upload\n          listType=\"picture\"\n          name=\"file\"\n          :action=\"upUrl\"\n          :headers=\"headers\"\n          @change=\"imgChange\"\n        >\n          <a-button style=\"margin-right:10px\">\n            <a-icon type=\"upload\" />点击上传\n          </a-button>\n\n          <template v-if=\"profileInfo.img\">\n            <img :src=\"profileInfo.img\" style=\"width: 120px; height: 100px\" />\n          </template>\n        </a-upload>\n      </a-form-model-item>\n\n      <a-form-model-item>\n        <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"updateProfile\">更新</a-button>\n      </a-form-model-item>\n    </a-form-model>\n  </a-card>\n</template>\n<script>\nimport { Url } from '../../plugin/http'\n\nexport default {\n  data() {\n    return {\n      profileInfo: {\n        id: 1,\n        name: '',\n        desc: '',\n        qq_chat: '',\n        wechat: '',\n        weibo: '',\n        bili: '',\n        email: '',\n        img: '',\n        avatar: '',\n        icp_record: '',\n      },\n      upUrl: Url + 'upload',\n      headers: {},\n    }\n  },\n  created() {\n    this.getProfileInfo()\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n  },\n  methods: {\n    // 获取个人设置\n    async getProfileInfo() {\n      const { data: res } = await this.$http.get(`profile/${this.profileInfo.id}`)\n      console.log(res)\n      if (res.status !== 200) {\n        if (res.status === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear()\n          this.$router.push('/login')\n        }\n        this.$message.error(res.message)\n      }\n      this.profileInfo = res.data\n    },\n\n    // 上传头像\n    avatarChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        const imgUrl = info.file.response.url\n        this.profileInfo.avatar = imgUrl\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n\n    // 上传头像背景图\n    imgChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        const imgUrl = info.file.response.url\n        this.profileInfo.img = imgUrl\n              console.log(this.profileInfo.img)\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n\n    // 更新\n    async updateProfile() {\n      const { data: res } = await this.$http.put(`profile/${this.profileInfo.id}`, this.profileInfo)\n      if (res.status !== 200) return this.$message.error(res.message)\n      this.$message.success(`个人信息更新成功`)\n      this.$router.push('/index')\n    },\n  },\n}\n</script>\n\n<style scoped>\n.upBtn {\n  margin-right: 10px;\n}\n</style>"]}]}