{"remainingRequest":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\user\\Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\user\\Profile.vue","mtime":1659593611446},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1659170823565},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1659170825069}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFVybCB9IGZyb20gJy4uLy4uL3BsdWdpbi9odHRwJwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9maWxlSW5mbzogewogICAgICAgIGlkOiAxLAogICAgICAgIG5hbWU6ICcnLAogICAgICAgIGRlc2M6ICcnLAogICAgICAgIHFxX2NoYXQ6ICcnLAogICAgICAgIHdlY2hhdDogJycsCiAgICAgICAgd2VpYm86ICcnLAogICAgICAgIGJpbGk6ICcnLAogICAgICAgIGVtYWlsOiAnJywKICAgICAgICBpbWc6ICcnLAogICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgaWNwX3JlY29yZDogJycsCiAgICAgIH0sCiAgICAgIHVwVXJsOiBVcmwgKyAndXBsb2FkJywKICAgICAgaGVhZGVyczoge30sCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRQcm9maWxlSW5mbygpCiAgICB0aGlzLmhlYWRlcnMgPSB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKX1gIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOiOt+WPluS4quS6uuiuvue9rgogICAgYXN5bmMgZ2V0UHJvZmlsZUluZm8oKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLmdldChgcHJvZmlsZS8ke3RoaXMucHJvZmlsZUluZm8uaWR9YCkKICAgICAgY29uc29sZS5sb2cocmVzKQogICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDEwMDQgfHwgMTAwNSB8fCAxMDA2IHx8IDEwMDcpIHsKICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5jbGVhcigpCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2xvZ2luJykKICAgICAgICB9CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgfQogICAgICB0aGlzLnByb2ZpbGVJbmZvID0gcmVzLmRhdGEKICAgIH0sCgogICAgLy8g5LiK5Lyg5aS05YOPCiAgICBhdmF0YXJDaGFuZ2UoaW5mbykgewogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyAhPT0gJ3VwbG9hZGluZycpIHsKICAgICAgfQogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2RvbmUnKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGDlm77niYfkuIrkvKDmiJDlip9gKQogICAgICAgIGNvbnN0IGltZ1VybCA9IGluZm8uZmlsZS5yZXNwb25zZS51cmwKICAgICAgICB0aGlzLnByb2ZpbGVJbmZvLmF2YXRhciA9IGltZ1VybAogICAgICB9IGVsc2UgaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICdlcnJvcicpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGDlm77niYfkuIrkvKDlpLHotKVgKQogICAgICB9CiAgICB9LAoKICAgIC8vIOS4iuS8oOWktOWDj+iDjOaZr+WbvgogICAgaW1nQ2hhbmdlKGluZm8pIHsKICAgICAgaWYgKGluZm8uZmlsZS5zdGF0dXMgIT09ICd1cGxvYWRpbmcnKSB7CiAgICAgIH0KICAgICAgaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICdkb25lJykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcyhg5Zu+54mH5LiK5Lyg5oiQ5YqfYCkKICAgICAgICBjb25zdCBpbWdVcmwgPSBpbmZvLmZpbGUucmVzcG9uc2UudXJsCiAgICAgICAgdGhpcy5wcm9maWxlSW5mby5pbWcgPSBpbWdVcmwKICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnByb2ZpbGVJbmZvLmltZykKICAgICAgfSBlbHNlIGlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAnZXJyb3InKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihg5Zu+54mH5LiK5Lyg5aSx6LSlYCkKICAgICAgfQogICAgfSwKCiAgICAvLyDmm7TmlrAKICAgIGFzeW5jIHVwZGF0ZVByb2ZpbGUoKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLnB1dChgcHJvZmlsZS8ke3RoaXMucHJvZmlsZUluZm8uaWR9YCwgdGhpcy5wcm9maWxlSW5mbykKICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpCiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcyhg5Liq5Lq65L+h5oGv5pu05paw5oiQ5YqfYCkKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9pbmRleCcpCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\n  <a-card>\n    <a-form-model labelAlign=\"left\" :label-col=\"{ span: 2 }\" :wrapper-col=\"{ span: 12 }\">\n      <a-form-model-item label=\"作者名称\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.name\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"个人简介\">\n        <a-input type=\"textarea\" v-model=\"profileInfo.desc\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"网站备案号\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.icp_record\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"QQ号码\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.qq_chat\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"微信\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.wechat\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"微博\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.weibo\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"B站地址\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.bili\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"Email\">\n        <a-input style=\"width: 300px\" v-model=\"profileInfo.email\"></a-input>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"头像\">\n        <a-upload\n          listType=\"picture\"\n          name=\"file\"\n          :action=\"upUrl\"\n          :headers=\"headers\"\n          @change=\"avatarChange\"\n        >\n          <a-button style=\"margin-right:10px\">\n            <a-icon type=\"upload\" />点击上传\n          </a-button>\n\n          <template v-if=\"profileInfo.avatar\">\n            <img :src=\"profileInfo.avatar\" style=\"width: 120px; height: 100px\" />\n          </template>\n        </a-upload>\n      </a-form-model-item>\n\n      <a-form-model-item label=\"头像背景图\">\n        <a-upload\n          listType=\"picture\"\n          name=\"file\"\n          :action=\"upUrl\"\n          :headers=\"headers\"\n          @change=\"imgChange\"\n        >\n          <a-button style=\"margin-right:10px\">\n            <a-icon type=\"upload\" />点击上传\n          </a-button>\n\n          <template v-if=\"profileInfo.img\">\n            <img :src=\"profileInfo.img\" style=\"width: 120px; height: 100px\" />\n          </template>\n        </a-upload>\n      </a-form-model-item>\n\n      <a-form-model-item>\n        <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"updateProfile\">更新</a-button>\n      </a-form-model-item>\n    </a-form-model>\n  </a-card>\n</template>\n<script>\nimport { Url } from '../../plugin/http'\n\nexport default {\n  data() {\n    return {\n      profileInfo: {\n        id: 1,\n        name: '',\n        desc: '',\n        qq_chat: '',\n        wechat: '',\n        weibo: '',\n        bili: '',\n        email: '',\n        img: '',\n        avatar: '',\n        icp_record: '',\n      },\n      upUrl: Url + 'upload',\n      headers: {},\n    }\n  },\n  created() {\n    this.getProfileInfo()\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n  },\n  methods: {\n    // 获取个人设置\n    async getProfileInfo() {\n      const { data: res } = await this.$http.get(`profile/${this.profileInfo.id}`)\n      console.log(res)\n      if (res.status !== 200) {\n        if (res.status === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear()\n          this.$router.push('/login')\n        }\n        this.$message.error(res.message)\n      }\n      this.profileInfo = res.data\n    },\n\n    // 上传头像\n    avatarChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        const imgUrl = info.file.response.url\n        this.profileInfo.avatar = imgUrl\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n\n    // 上传头像背景图\n    imgChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        const imgUrl = info.file.response.url\n        this.profileInfo.img = imgUrl\n              console.log(this.profileInfo.img)\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n\n    // 更新\n    async updateProfile() {\n      const { data: res } = await this.$http.put(`profile/${this.profileInfo.id}`, this.profileInfo)\n      if (res.status !== 200) return this.$message.error(res.message)\n      this.$message.success(`个人信息更新成功`)\n      this.$router.push('/index')\n    },\n  },\n}\n</script>\n\n<style scoped>\n.upBtn {\n  margin-right: 10px;\n}\n</style>"]}]}