{"remainingRequest":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\article\\AddArt.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\article\\AddArt.vue","mtime":1659543986950},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1659170823565},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1659170825069}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFVybCB9IGZyb20gJy4uLy4uL3BsdWdpbi9odHRwJwppbXBvcnQgRWRpdG9yIGZyb20gJy4uL2VkaXRvci9pbmRleCcKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgRWRpdG9yIH0sCiAgcHJvcHM6IFsnaWQnXSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYXJ0SW5mbzogewogICAgICAgIGlkOiAwLAogICAgICAgIHRpdHRsZTogJycsCiAgICAgICAgY2lkOiB1bmRlZmluZWQsCiAgICAgICAgZGVzYzogJycsCiAgICAgICAgY29udGVudDogJycsCiAgICAgICAgaW1nOiAnJywKICAgICAgfSwKICAgICAgQ2F0ZWxpc3Q6IFtdLAogICAgICB1cFVybDogVXJsICsgJ3VwbG9hZCcsCiAgICAgIGhlYWRlcnM6IHt9LAogICAgICBmaWxlTGlzdDogW10sCiAgICAgIGFydEluZm9SdWxlczogewogICAgICAgIHRpdGxlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+eroOagh+mimCcsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dLAogICAgICAgIGNpZDogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmlofnq6DliIbnsbsnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwKICAgICAgICBkZXNjOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5paH56ug5o+P6L+wJywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICAgIHsgbWF4OiAxMjAsIG1lc3NhZ2U6ICfmj4/ov7DmnIDlpJrlj6/lhpkxMjDkuKrlrZfnrKYnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgIF0sCiAgICAgICAgLy8gaW1nOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeaWh+eroOe8qeeVpeWbvicsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dLAogICAgICAgIGNvbnRlbnQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5paH56ug5YaF5a65JywgdHJpZ2dlcjogJ2NoYW5nZScgfV0sCiAgICAgIH0sCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRDYXRlTGlzdCgpCiAgICB0aGlzLmhlYWRlcnMgPSB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKX1gIH0KICAgIGlmICh0aGlzLmlkKSB7CiAgICAgIHRoaXMuZ2V0QXJ0SW5mbyh0aGlzLmlkKQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5p+l6K+i5paH56ug5L+h5oGvCiAgICBhc3luYyBnZXRBcnRJbmZvKGlkKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLmdldChgL2FydGljbGUvJHtpZH1gKQogICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDEwMDQgfHwgMTAwNSB8fCAxMDA2IHx8IDEwMDcpIHsKICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5jbGVhcigpCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICB0aGlzLmFydEluZm8gPSByZXMuZGF0YQogICAgICB0aGlzLmFydEluZm8uaWQgPSByZXMuZGF0YS5JRAogICAgfSwKICAgIC8vIOiOt+WPluWIhuexu+WIl+ihqAogICAgYXN5bmMgZ2V0Q2F0ZUxpc3QoKSB7CiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLmdldCgnY2F0ZWdvcnkvZ2V0Y2F0ZWdvcnlzJywgewogICAgICAgIHBhcmFtczogewogICAgICAgICAgcGFnZXNpemU6IDAsCiAgICAgICAgICBwYWdlbnVtOiAwLAogICAgICAgIH0sCiAgICAgIH0pCiAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKQogICAgICB0aGlzLkNhdGVsaXN0ID0gcmVzLmRhdGEKICAgIH0sCiAgICAvLyDpgInmi6nliIbnsbsKICAgIGNhdGVDaGFuZ2UodmFsdWUpIHsKICAgICAgdGhpcy5hcnRJbmZvLmNpZCA9IHZhbHVlCiAgICB9LAogICAgLy8g5LiK5Lyg5Zu+54mHCiAgICB1cENoYW5nZShpbmZvKSB7CiAgICAgIGlmIChpbmZvLmZpbGUuc3RhdHVzICE9PSAndXBsb2FkaW5nJykgewogICAgICB9CiAgICAgIGlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAnZG9uZScpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoYOWbvueJh+S4iuS8oOaIkOWKn2ApCiAgICAgICAgdGhpcy5hcnRJbmZvLmltZyA9IGluZm8uZmlsZS5yZXNwb25zZS51cmwKICAgICAgfSBlbHNlIGlmIChpbmZvLmZpbGUuc3RhdHVzID09PSAnZXJyb3InKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihg5Zu+54mH5LiK5Lyg5aSx6LSlYCkKICAgICAgfQogICAgfSwKICAgIC8vIOaPkOS6pCYm5pu05paw5paH56ugCiAgICBhcnRPayhpZCkgewogICAgICB0aGlzLiRyZWZzLmFydEluZm9SZWYudmFsaWRhdGUoYXN5bmMgKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WPguaVsOmqjOivgeacqumAmui/h++8jOivt+aMieimgeaxguW9leWFpeaWh+eroOWGheWuuScpCiAgICAgICAgaWYgKGlkID09PSAwKSB7CiAgICAgICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCdhcnRpY2xlL2FkZCcsIHRoaXMuYXJ0SW5mbykKICAgICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9hcnRsaXN0JykKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5re75Yqg5paH56ug5oiQ5YqfJykKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAucHV0KGBhcnRpY2xlLyR7aWR9YCwgdGhpcy5hcnRJbmZvKQogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpCgogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9hcnRsaXN0JykKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pu05paw5paH56ug5oiQ5YqfJykKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAoKICAgIGFkZENhbmNlbCgpIHsKICAgICAgdGhpcy4kcmVmcy5hcnRJbmZvUmVmLnJlc2V0RmllbGRzKCkKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["AddArt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"AddArt.vue","sourceRoot":"src/components/article","sourcesContent":["<template>\n  <div>\n    <a-card>\n      <h3>{{ id ? '编辑文章' : '新增文章' }}</h3>\n\n      <a-form-model :model=\"artInfo\" ref=\"artInfoRef\" :rules=\"artInfoRules\"\n        :hideRequiredMark=\"true\">\n        <a-row :gutter=\"24\" type=\"flex\" justify=\"start\" :span=\"16\">\n          <a-col :span=\"5\">\n            <a-form-model-item label=\"文章标题\" prop=\"title\">\n              <a-input style=\"width: 300px\" v-model=\"artInfo.tittle\"></a-input>\n            </a-form-model-item>\n            </a-col>\n            </a-row>\n            <a-row :gutter=\"24\" type=\"flex\" justify=\"start\" >\n            <a-col :span=\"16\">\n            <a-form-model-item label=\"文章描述\" prop=\"desc\">\n              <a-input type=\"textarea\" v-model=\"artInfo.desc\"></a-input>\n            </a-form-model-item>\n            </a-col>\n          </a-row>\n          <a-row :gutter=\"24\" type=\"flex\" justify=\"start\">\n            <a-col :span=\"2\">\n            <a-form-model-item label=\"文章分类\" prop=\"cid\">\n              <a-select style=\"width: 200px\" v-model=\"artInfo.cid\" placeholder=\"请选择分类\"\n                @change=\"cateChange\">\n                <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">\n                  {{\n                      item.name\n                  }}\n                </a-select-option>\n              </a-select>\n            </a-form-model-item>\n            </a-col>\n          </a-row>\n          <a-row  type=\"flex\" justify=\"start\">\n            <a-col :span=\"2\">\n            <a-form-model-item label=\"文章缩略图\" prop=\"img\">\n              <a-upload listType=\"picture\" name=\"file\" :action=\"upUrl\" :headers=\"headers\"\n                @change=\"upChange\">\n                <a-button>\n                  <a-icon type=\"upload\" />点击上传\n                </a-button>\n                <br />\n                <template v-if=\"id\">\n                  <img :src=\"artInfo.img\" style=\"width: 120px; height: 100px; margin-left: 15px\" />\n                </template>\n              </a-upload>\n            </a-form-model-item>\n            </a-col>\n        </a-row>\n        <a-form-model-item label=\"文章内容\" prop=\"content\">\n          <Editor v-model=\"artInfo.content\"></Editor>\n        </a-form-model-item>\n\n        <a-form-model-item>\n          <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"artOk(artInfo.id)\">\n            {{\n                artInfo.id ? '更新' : '提交'\n            }}\n          </a-button>\n          <a-button type=\"primary\" @click=\"addCancel\">取消</a-button>\n        </a-form-model-item>\n      </a-form-model>\n    </a-card>\n  </div>\n</template>\n\n<script>\nimport { Url } from '../../plugin/http'\nimport Editor from '../editor/index'\nexport default {\n  components: { Editor },\n  props: ['id'],\n  data() {\n    return {\n      artInfo: {\n        id: 0,\n        tittle: '',\n        cid: undefined,\n        desc: '',\n        content: '',\n        img: '',\n      },\n      Catelist: [],\n      upUrl: Url + 'upload',\n      headers: {},\n      fileList: [],\n      artInfoRules: {\n        title: [{ required: true, message: '请输入文章标题', trigger: 'change' }],\n        cid: [{ required: true, message: '请选择文章分类', trigger: 'change' }],\n        desc: [\n          { required: true, message: '请输入文章描述', trigger: 'change' },\n          { max: 120, message: '描述最多可写120个字符', trigger: 'change' },\n        ],\n        // img: [{ required: true, message: '请选择文章缩略图', trigger: 'change' }],\n        content: [{ required: true, message: '请输入文章内容', trigger: 'change' }],\n      },\n    }\n  },\n  mounted() {\n    this.getCateList()\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n    if (this.id) {\n      this.getArtInfo(this.id)\n    }\n  },\n  methods: {\n    // 查询文章信息\n    async getArtInfo(id) {\n      const { data: res } = await this.$http.get(`/article/${id}`)\n      if (res.status !== 200) {\n        if (res.status === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear()\n          this.$message.error(res.message)\n          this.$router.push('/login')\n          return\n        }\n        this.$message.error(res.message)\n        return\n      }\n      this.artInfo = res.data\n      this.artInfo.id = res.data.ID\n    },\n    // 获取分类列表\n    async getCateList() {\n      const { data: res } = await this.$http.get('category/getcategorys', {\n        params: {\n          pagesize: 0,\n          pagenum: 0,\n        },\n      })\n      if (res.status !== 200) return this.$message.error(res.message)\n      this.Catelist = res.data\n    },\n    // 选择分类\n    cateChange(value) {\n      this.artInfo.cid = value\n    },\n    // 上传图片\n    upChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        this.artInfo.img = info.file.response.url\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n    // 提交&&更新文章\n    artOk(id) {\n      this.$refs.artInfoRef.validate(async (valid) => {\n        if (!valid) return this.$message.error('参数验证未通过，请按要求录入文章内容')\n        if (id === 0) {\n          const { data: res } = await this.$http.post('article/add', this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n          this.$router.push('/artlist')\n          this.$message.success('添加文章成功')\n        } else {\n          const { data: res } = await this.$http.put(`article/${id}`, this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n\n          this.$router.push('/artlist')\n          this.$message.success('更新文章成功')\n        }\n      })\n    },\n\n    addCancel() {\n      this.$refs.artInfoRef.resetFields()\n    },\n  },\n}\n</script>"]}]}