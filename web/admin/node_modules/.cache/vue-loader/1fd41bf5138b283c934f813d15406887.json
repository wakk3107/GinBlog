{"remainingRequest":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\article\\AddArt.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\src\\components\\article\\AddArt.vue","mtime":1659594717222},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1659170823565},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659170820870},{"path":"C:\\Users\\wakk\\GolandProjects\\GinBlog\\web\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1659170825069}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFVybCB9IGZyb20gJy4uLy4uL3BsdWdpbi9odHRwJwppbXBvcnQgRWRpdG9yIGZyb20gJy4uL2VkaXRvci9pbmRleCcKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgRWRpdG9yIH0sCiAgcHJvcHM6IFsnaWQnXSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYXJ0SW5mbzogewogICAgICAgIGlkOiAwLAogICAgICAgIHRpdHRsZTogJycsCiAgICAgICAgY2lkOiB1bmRlZmluZWQsCiAgICAgICAgZGVzYzogJycsCiAgICAgICAgY29udGVudDogJycsCiAgICAgICAgaW1nOiAnJywKICAgICAgfSwKICAgICAgQ2F0ZWxpc3Q6IFtdLAogICAgICB1cFVybDogVXJsICsgJ3VwbG9hZCcsCiAgICAgIGhlYWRlcnM6IHt9LAogICAgICBmaWxlTGlzdDogW10sCiAgICAgIGFydEluZm9SdWxlczogewogICAgICAgIHRpdGxlOiBbeyByZXF1aXJlZDogZmFsc2UsIG1lc3NhZ2U6ICfor7fovpPlhaXmlofnq6DmoIfpopgnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwKICAgICAgICBjaWQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5paH56ug5YiG57G7JywgdHJpZ2dlcjogJ2NoYW5nZScgfV0sCiAgICAgICAgZGVzYzogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+eroOaPj+i/sCcsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICB7IG1heDogMTIwLCBtZXNzYWdlOiAn5o+P6L+w5pyA5aSa5Y+v5YaZMTIw5Liq5a2X56ymJywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICBdLAogICAgICAgIC8vIGltZzogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmlofnq6DnvKnnlaXlm74nLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwKICAgICAgICBjb250ZW50OiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaWh+eroOWGheWuuScsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dLAogICAgICB9LAogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0Q2F0ZUxpc3QoKQogICAgdGhpcy5oZWFkZXJzID0geyBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7d2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyl9YCB9CiAgICBpZiAodGhpcy5pZCkgewogICAgICB0aGlzLmdldEFydEluZm8odGhpcy5pZCkKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOafpeivouaWh+eroOS/oeaBrwogICAgYXN5bmMgZ2V0QXJ0SW5mbyhpZCkgewogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoYC9hcnRpY2xlLyR7aWR9YCkKICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAxMDA0IHx8IDEwMDUgfHwgMTAwNiB8fCAxMDA3KSB7CiAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvbG9naW4nKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgdGhpcy5hcnRJbmZvID0gcmVzLmRhdGEKICAgICAgdGhpcy5hcnRJbmZvLmlkID0gcmVzLmRhdGEuSUQKICAgIH0sCiAgICAvLyDojrflj5bliIbnsbvliJfooagKICAgIGFzeW5jIGdldENhdGVMaXN0KCkgewogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoJ2NhdGVnb3J5L2dldGNhdGVnb3J5cycsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2VzaXplOiAwLAogICAgICAgICAgcGFnZW51bTogMCwKICAgICAgICB9LAogICAgICB9KQogICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgdGhpcy5DYXRlbGlzdCA9IHJlcy5kYXRhCiAgICB9LAogICAgLy8g6YCJ5oup5YiG57G7CiAgICBjYXRlQ2hhbmdlKHZhbHVlKSB7CiAgICAgIHRoaXMuYXJ0SW5mby5jaWQgPSB2YWx1ZQogICAgfSwKICAgIC8vIOS4iuS8oOWbvueJhwogICAgdXBDaGFuZ2UoaW5mbykgewogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyAhPT0gJ3VwbG9hZGluZycpIHsKICAgICAgfQogICAgICBpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2RvbmUnKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGDlm77niYfkuIrkvKDmiJDlip9gKQogICAgICAgIHRoaXMuYXJ0SW5mby5pbWcgPSBpbmZvLmZpbGUucmVzcG9uc2UudXJsCiAgICAgIH0gZWxzZSBpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2Vycm9yJykgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoYOWbvueJh+S4iuS8oOWksei0pWApCiAgICAgIH0KICAgIH0sCiAgICAvLyDmj5DkuqQmJuabtOaWsOaWh+eroAogICAgYXJ0T2soaWQpIHsKICAgICAgdGhpcy4kcmVmcy5hcnRJbmZvUmVmLnZhbGlkYXRlKGFzeW5jICh2YWxpZCkgPT4gewogICAgICAgIGlmICghdmFsaWQpIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCflj4LmlbDpqozor4HmnKrpgJrov4fvvIzor7fmjInopoHmsYLlvZXlhaXmlofnq6DlhoXlrrknKQogICAgICAgIGlmIChpZCA9PT0gMCkgewogICAgICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgnYXJ0aWNsZS9hZGQnLCB0aGlzLmFydEluZm8pCiAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubWVzc2FnZSkKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvYXJ0bGlzdCcpCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+a3u+WKoOaWh+eroOaIkOWKnycpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLnB1dChgYXJ0aWNsZS8ke2lkfWAsIHRoaXMuYXJ0SW5mbykKICAgICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKQoKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvYXJ0bGlzdCcpCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+abtOaWsOaWh+eroOaIkOWKnycpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKCiAgICBhZGRDYW5jZWwoKSB7CiAgICAgIHRoaXMuJHJlZnMuYXJ0SW5mb1JlZi5yZXNldEZpZWxkcygpCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["AddArt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"AddArt.vue","sourceRoot":"src/components/article","sourcesContent":["<template>\n  <div>\n    <a-card>\n      <h3>{{ id ? '编辑文章' : '新增文章' }}</h3>\n\n      <a-form-model :model=\"artInfo\" ref=\"artInfoRef\" :rules=\"artInfoRules\"\n        :hideRequiredMark=\"true\">\n        <a-row :gutter=\"24\" type=\"flex\" justify=\"start\" :span=\"16\">\n          <a-col :span=\"5\">\n            <a-form-model-item label=\"文章标题\" prop=\"title\">\n              <a-input style=\"width: 300px\" v-model=\"artInfo.tittle\"></a-input>\n            </a-form-model-item>\n            </a-col>\n            </a-row>\n            <a-row :gutter=\"24\" type=\"flex\" justify=\"start\" >\n            <a-col :span=\"16\">\n            <a-form-model-item label=\"文章描述\" prop=\"desc\">\n              <a-input type=\"textarea\" v-model=\"artInfo.desc\"></a-input>\n            </a-form-model-item>\n            </a-col>\n          </a-row>\n          <a-row :gutter=\"24\" type=\"flex\" justify=\"start\">\n            <a-col :span=\"2\">\n            <a-form-model-item label=\"文章分类\" prop=\"cid\">\n              <a-select style=\"width: 200px\" v-model=\"artInfo.cid\" placeholder=\"请选择分类\"\n                @change=\"cateChange\">\n                <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">\n                  {{\n                      item.name\n                  }}\n                </a-select-option>\n              </a-select>\n            </a-form-model-item>\n            </a-col>\n          </a-row>\n          <a-row  type=\"flex\" justify=\"start\">\n            <a-col :span=\"2\">\n            <a-form-model-item label=\"文章缩略图\" prop=\"img\">\n              <a-upload listType=\"picture\" name=\"file\" :action=\"upUrl\" :headers=\"headers\"\n                @change=\"upChange\">\n                <a-button>\n                  <a-icon type=\"upload\" />点击上传\n                </a-button>\n                <br />\n                <template v-if=\"id\">\n                  <img :src=\"artInfo.img\" style=\"width: 120px; height: 100px; margin-left: 15px\" />\n                </template>\n              </a-upload>\n            </a-form-model-item>\n            </a-col>\n        </a-row>\n        <a-form-model-item label=\"文章内容\" prop=\"content\">\n          <Editor v-model=\"artInfo.content\"></Editor>\n        </a-form-model-item>\n\n        <a-form-model-item>\n          <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"artOk(artInfo.id)\">\n            {{\n                artInfo.id ? '更新' : '提交'\n            }}\n          </a-button>\n          <a-button type=\"primary\" @click=\"addCancel\">取消</a-button>\n        </a-form-model-item>\n      </a-form-model>\n    </a-card>\n  </div>\n</template>\n\n<script>\nimport { Url } from '../../plugin/http'\nimport Editor from '../editor/index'\nexport default {\n  components: { Editor },\n  props: ['id'],\n  data() {\n    return {\n      artInfo: {\n        id: 0,\n        tittle: '',\n        cid: undefined,\n        desc: '',\n        content: '',\n        img: '',\n      },\n      Catelist: [],\n      upUrl: Url + 'upload',\n      headers: {},\n      fileList: [],\n      artInfoRules: {\n        title: [{ required: false, message: '请输入文章标题', trigger: 'change' }],\n        cid: [{ required: true, message: '请选择文章分类', trigger: 'change' }],\n        desc: [\n          { required: true, message: '请输入文章描述', trigger: 'change' },\n          { max: 120, message: '描述最多可写120个字符', trigger: 'change' },\n        ],\n        // img: [{ required: true, message: '请选择文章缩略图', trigger: 'change' }],\n        content: [{ required: true, message: '请输入文章内容', trigger: 'change' }],\n      },\n    }\n  },\n  mounted() {\n    this.getCateList()\n    this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n    if (this.id) {\n      this.getArtInfo(this.id)\n    }\n  },\n  methods: {\n    // 查询文章信息\n    async getArtInfo(id) {\n      const { data: res } = await this.$http.get(`/article/${id}`)\n      if (res.status !== 200) {\n        if (res.status === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear()\n          this.$message.error(res.message)\n          this.$router.push('/login')\n          return\n        }\n        this.$message.error(res.message)\n        return\n      }\n      this.artInfo = res.data\n      this.artInfo.id = res.data.ID\n    },\n    // 获取分类列表\n    async getCateList() {\n      const { data: res } = await this.$http.get('category/getcategorys', {\n        params: {\n          pagesize: 0,\n          pagenum: 0,\n        },\n      })\n      if (res.status !== 200) return this.$message.error(res.message)\n      this.Catelist = res.data\n    },\n    // 选择分类\n    cateChange(value) {\n      this.artInfo.cid = value\n    },\n    // 上传图片\n    upChange(info) {\n      if (info.file.status !== 'uploading') {\n      }\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`)\n        this.artInfo.img = info.file.response.url\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`)\n      }\n    },\n    // 提交&&更新文章\n    artOk(id) {\n      this.$refs.artInfoRef.validate(async (valid) => {\n        if (!valid) return this.$message.error('参数验证未通过，请按要求录入文章内容')\n        if (id === 0) {\n          const { data: res } = await this.$http.post('article/add', this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n          this.$router.push('/artlist')\n          this.$message.success('添加文章成功')\n        } else {\n          const { data: res } = await this.$http.put(`article/${id}`, this.artInfo)\n          if (res.status !== 200) return this.$message.error(res.message)\n\n          this.$router.push('/artlist')\n          this.$message.success('更新文章成功')\n        }\n      })\n    },\n\n    addCancel() {\n      this.$refs.artInfoRef.resetFields()\n    },\n  },\n}\n</script>"]}]}